# Отчёт по лабораторной работе №5 
**Модернизация веб-приложения с переходом на Fetch API**

**Выполнил студент группы ИС-23: Остафинский В. А.**

---

## Структура проекта

### Корневая директория
| Файл/Папка         | Назначение                                                                 |
|---------------------|---------------------------------------------------------------------------|
| `index.html`        | Главная HTML-страница приложения с Bootstrap                             |
| `main.js`           | Точка входа JavaScript приложения, проверка конфигурации                 |
| `package.json`      | Метаданные проекта и зависимости (Bootstrap)                             |
| `package-lock.json` | Фиксация версий зависимостей                                             |

### Папка `node_modules/` — зависимости
| Назначение                                                                 |
|----------------------------------------------------------------------------|
| Установленные npm-пакеты                              |

### Папка `modules/` — модули для работы с API
| Файл               | Назначение                                                                 |
|--------------------|---------------------------------------------------------------------------|
| `ajax.js`          | Класс для работы с Fetch API                    |
| `consts.js`        | Константы: groupId, accessToken, version VK API                           |
| `urls.js`          | Генератор URL для запросов к VK API                                       |

### Папка `pages/` — страницы приложения
| Файл                     | Назначение                                                                 |
|--------------------------|---------------------------------------------------------------------------|
| `main/index.js`          | Главная страница со списком участников группы VK                          |
| `user/index.js`          | Страница детальной информации о пользователе VK                           |

### Папка `components/` — компоненты приложения
| Файл                          | Назначение                                                                 |
|-------------------------------|---------------------------------------------------------------------------|
| `user-card/index.js`          | Карточка пользователя для главной страницы                                |
| `accordion/index.js`          | Аккордеон для отображения информации на странице пользователя             |
| `back-button/index.js`        | Кнопка "Назад" для возврата на предыдущую страницу                        |
| `sort-filter/index.js`        | Компонент сортировки участников (выполнение задания варианта)             |

---

## Проделанная работа

### **Выполнение задания по варианту 1**

**Выполнено:**
- Замена XMLHttpRequest на Fetch API во всех модулях приложения

**1. Настройка работы с VK API**
   - Создано сообщество в VK
   - Получен access token с необходимыми правами
   - Настроены константы в `modules/consts.js`
   - Реализовано решение проблемы CORS

**2. Модуль для работы с API**
   - Переписан класс `Ajax` в файле `ajax.js`
   - Удалён устаревший код с `XMLHttpRequest`
   - Реализованы асинхронные методы `get()` и `post()` с использованием Fetch API
   - Обработка ошибок сети и JSON парсинга
   - Реализована централизованная обработка ошибок в блоке `try/catch`

**3. Генерация URL для VK API**
   - Класс `Urls` для формирования запросов
   - Метод `getGroupMembers()` с поддержкой параметра `sort`
   - Метод `getUserInfo()` с расширенными полями:
     - Основная информация
     - Фотография
     - Город, дата рождения, пол
     - Семейное положение
     - Онлайн статус
     - Жизненная позиция — дополнительная информация

**4. Главная страница**
   - Получение списка участников группы через API
   - Динамическая отрисовка карточек пользователей
   - Интеграция компонента сортировки:
     - Обработчик изменения сортировки
     - Перезагрузка данных при изменении фильтра
     - Визуальное отображение текущей сортировки
   - Обработка ошибок API
   - Навигация на страницу пользователя

**5. Компонент сортировки** 
   - Выпадающий список с 5 вариантами сортировки
   - Описание каждого типа сортировки
   - Callback при изменении выбора

**6. Карточка пользователя**
   - Отображение фотографии, имени и фамилии
   - Уникальный ID для каждой карточки
   - Кнопка перехода к детальной информации

**7. Страница пользователя**
   - Получение расширенной информации через `users.get`
   - Парсинг сложных данных VK API:
     - Форматирование даты рождения (с учетом скрытого года)
     - Преобразование кодов пола в текст
     - Маппинг кодов семейного положения
     - Обработка времени последнего входа
   - Детальная обработка поля `personal`:
     - Политические взгляды (9 вариантов)
     - Религия
     - Главное в жизни (8 вариантов)
     - Главное в людях (6 вариантов)
     - Отношение к курению и алкоголю (шкала 1-5)
     - Вдохновляющие люди
   - Использование аккордеона для организации информации:
     - Основная информация
     - География и активность
     - Жизненная позиция
     - Ссылки
   - Кнопка возврата на главную страницу

**8. Компонент аккордеона**
   - Динамическое создание аккордеон-элементов
   - Поддержка Bootstrap Accordion

**9. Проверка конфигурации**
   - Проверка наличия корректных констант
   - Информативное сообщение при ошибке настройки
   - Запуск приложения только при валидной конфигурации

---

## Как запустить

**Через Live Server**
   - Установите расширение Live Server для VS Code
   - Откройте VS Code
   - Настройте конфигурацию VK API
     - Откройте файл `modules/consts.js`
     - Замените значения:
        ```
        export const groupId = 'ВАШ_ID_ГРУППЫ'; 
        export const accessToken = 'ВАШ_ACCESS_TOKEN';
        ```
   - Откройте файл `index.html`
   - Нажмите кнопку "Go Live" в правом нижнем углу VS Code
   - Включите CORS расширение в браузере
     - Установите расширение "CORS Unblock" для вашего браузера
     - Включите его для текущего сайта
